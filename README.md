# GraphNeuralNetworks

Minimal repository for experimenting with message-passing graph neural networks (GNNs) for molecular data.

## Overview
This repo contains:
- `Solvents.txt` 
    - A curated list of solvents compiled from a COSMO database and supervisor annotations.
- `src/` 
    -  Source code folder, contains:
    -  `GNN.py` 
        - Implementation of a simple message-passing Graph Neural Network object `simpleGNN`.
    - `GNNLayer.py` 
        - GNN layer implementation (message + update).
    - `Graphs/` 
        - Folder for molecular graph data structures (molecule_graph), contains: 
        - `Graphs.py` 
            - Definition of `undirected_graph` and `molecule_graph` object.
        - `SMILEStoGraph.py` 
            - Script to generate/instantiate `molecule_graph` objects from SMILES strings. **Hardcoded `Solvents.txt` import**
        - `graph_viz/` 
            - Folder for `undirected_graph` object visualization. The `undirected_graph` object automatically writes to `graph_viz/graphData.js` if the `plot` function is used.
        - `molecule_viz/` 
            - folder for `molecule_graph` object visualization. The `molecule_graph` object automatically writes to `molecule_viz/graphData.js` if the `plot` function is used.

The code is intended for research and prototyping: constructing molecular graphs from SMILES, featurising nodes/edges, and training or evaluating a simple message-passing GNN.

## Repository layout
- README.md
- Solvents.txt
- src/
    - GNN.py
    - GNNLayer.py
    - Graphs/
        - moleculegraph.py
        - SMILEStoGraph.py
- pyproject.toml (Used for dependencies management)

## Requirements

See pyproject.toml. 
I used poetry for dependency management. If you have poetry just execute the following lines in the terminal:

```bash
poetry lock 
poetry install
```
<!--
THES USAGE EXAMPLES DO NOT WORK 
THE CODE WAS GENERATED BY COPILOT 
BUT CONSIDER THE ARGUMENT PASSING AS A POSSIBLE FUTURE PROJECT TO EXTEND THIS REPO. 

## Usage examples

1) Convert a SMILES string to a graph object:
```bash
python src/SMILEStoGraph/convert_smiles.py "CCO"
```
Or, from Python:
```python
from src.SMILEStoGraph.convert_smiles import smiles_to_graph
g = smiles_to_graph("CCO")  # returns a MoleculeGraph instance
```

2) Instantiate a GNN layer / model and run a forward pass:
```python
from src.GNN.GNNLayer import GNNLayer
# example: node_dim and edge_dim depend on your featurisation
layer = GNNLayer(node_dim=64, edge_dim=8)
out_nodes = layer(node_features, edge_index, edge_features)
```

3) Training loop sketch (pseudocode):
```python
# prepare dataset of MoleculeGraph objects and labels (e.g. solvent properties)
# convert to batches or use custom collate
model = YourGNNModel(...)
optimizer = torch.optim.Adam(model.parameters(), lr=1e-3)
for batch in dataloader:
        preds = model(batch)
        loss = loss_fn(preds, batch.labels)
        loss.backward()
        optimizer.step()
        optimizer.zero_grad()
``` 

-->

